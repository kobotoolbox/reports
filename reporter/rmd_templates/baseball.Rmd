```{r, echo=FALSE, results='asis'}
data <- read.csv('{{ url }}')
nrow(data)
```

# A Baseball Report

This report aims to show the versatility of using `knitr` to construct reports. The abilitiy to interweave text and figures seems extremely valuable. Let's make sure that we've restricted the data to the right set of teams.

```{r, results='asis'}
library(pander)
library(ggplot2)
library(plyr)

counts <- data.frame(table(data$home))
names(counts) <- c('Team', 'Games')
pandoc.table(counts, style='rmarkdown')
```

Let's see if there's an obvious home field advantage.

```{r}
(
    ggplot(data, aes(x=homescore, y=visscore)) +
    geom_jitter(alpha=0.25) +
    coord_fixed(ratio=1) +
    xlab('Home team score') + ylab('Away team score')
    )
```

```{r, results='asis'}
stats <- ddply(data, 'home', function(df) c(
    average.margin.of.victory=mean(abs(df$homescore - df$visscore))
    ))
pandoc.table(stats, style='rmarkdown')
```
